(this["webpackJsonpreact-game"]=this["webpackJsonpreact-game"]||[]).push([[0],{17:function(e,t,n){},36:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var c,a,r=n(0),i=n(20),s=n.n(i),o=(n(36),n(31)),l=(n(17),n(4)),u=n(5),j=n(10),d=n.p+"static/media/bensound-dreams.c705f4ca.mp3",f=n.p+"static/media/throw.1e583756.mp3",m=n(11),b=n(63),p=function(e,t){return t.filter((function(t){return!e.find((function(e){return e.row===t.row&&e.col===t.col}))}))},h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,c=t.filter((function(e){return!e.shouldDelete})).length;n=e.length-c<n?e.length-c:n;var a=p(t,e),r=[];return Array(n).fill(0).forEach((function(n){r.push(Object(l.a)(Object(l.a)({},a[Math.floor(Math.random()*a.length)]),{},{value:2,key:Object(b.a)(),appeared:!0})),a=p([].concat(Object(m.a)(t),r),e)})),e.length===c?{tileList:t,statusResult:"over"}:{tileList:[].concat(Object(m.a)(t),r)}},O=function(e){return e.reduce((function(e,t,n,c){if(n+1<c.length&&t.value===c[n+1].value&&!t.shouldDelete){var a=Object(l.a)(Object(l.a)({},t),{},{key:Object(b.a)(),value:t.value&&(t.value*=2),merged:!0});t.shouldDelete=!0,c[n+1].shouldDelete=!0,e.push(a,t)}else e.push(t);return e}),[])},g=function(e,t,n){switch(t){case"right":e.sort((function(e,t){return t.col-e.col}));var c=n;return O(e).map((function(e,t,n){return e.col=c,n[t+1]&&!n[t+1].shouldDelete&&(c-=1),e})).sort((function(e,t){return e.col-t.col}));case"left":e.sort((function(e,t){return e.col-t.col}));var a=1;return O(e).map((function(e,t,n){return e.col=a,n[t+1]&&!n[t+1].shouldDelete&&(a+=1),e}));case"up":e.sort((function(e,t){return e.row-t.row}));var r=1;return O(e).map((function(e,t,n){return e.row=r,n[t+1]&&!n[t+1].shouldDelete&&(r+=1),e}));case"down":e.sort((function(e,t){return t.row-e.row}));var i=n;return O(e).map((function(e,t,n){return e.row=i,n[t+1]&&!n[t+1].shouldDelete&&(i-=1),e})).sort((function(e,t){return e.row-t.row}))}},v=function(e,t,n){var c=e.filter((function(e){return!e.shouldDelete}));switch(c.forEach((function(e){delete e.appeared,delete e.merged})),t){case"right":case"left":return function(e,t){return Array.from({length:t}).map((function(t,n){return e.filter((function(e){return e.row===n+1}))}))}(c,n).map((function(e){return g(e,t,n)})).flat();case"up":case"down":return function(e,t){return Array.from({length:t}).map((function(t,n){return e.filter((function(e){return e.col===n+1}))}))}(c,n).map((function(e){return g(e,t,n)})).flat()}};!function(e){e.RowSize="Row size",e.NewTiles="New tiles",e.ColorTheme="Color theme",e.MusicVolume="Music volume",e.MusicOn="Music play/stop",e.SoundVolime="Sounds volume",e.SoundOn="Mute sounds"}(c||(c={})),function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.KeyUp="KeyW",e.KeyDown="KeyS",e.KeyLeft="KeyA",e.KeyRight="KeyD",e.NewGame="KeyN",e.Settings="KeyC",e.EscapeSettings="Escape"}(a||(a={}));var x=n(28),w=n(23),N=n(1),y=function(e){var t=e.tile,n=e.enterLeaveStyles,c=e.gameConfig,a=function(e,t){switch(e.value){case 2:case 4:case 8:case 16:case 32:case 64:return.55*t;case 128:case 256:case 512:return.45*t;case 1024:case 2048:return.35*t}}(t,c.tileWidth),r=Object(w.b)({top:(t.row-1)*(c.tileWidth+c.tileGap)+c.tileGap,left:(t.col-1)*(c.tileWidth+c.tileGap)+c.tileGap,config:{duration:150},height:c.tileWidth,width:c.tileWidth,fontSize:a});return Object(N.jsx)(w.a.div,{className:"Tile Value-".concat(t.value," ").concat(t.merged?"Merged":""," ").concat(c.isDarkTheme?"DarkTheme":""),style:Object(l.a)(Object(l.a)({},r),n),children:t.value})},S=function(e){var t=e.tileList,n=e.gameConfig;return Object(N.jsx)("div",{children:Object(N.jsx)(x.Transition,{items:t,keys:t.map((function(e){return e.key})),from:function(e){return e.merged?{transform:"scale(1)"}:{transform:"scale(0)"}},enter:{transform:"scale(1)"},leave:{transform:"scale(0)"},config:{duration:0},children:function(e){return function(t){return Object(N.jsx)(y,{tile:e,enterLeaveStyles:t,gameConfig:n},e.key)}}})})},k=n(7),T=n.p+"static/media/click.504e3127.wav",C=function(e){var t=e.startNewGame,n=e.toggleMusic,c=e.musicConfig,a=e.openSettings,r=e.startBtnIcon,i=Object(j.a)(T,{volume:.5}),s=Object(u.a)(i,1)[0];return Object(N.jsxs)("div",{className:"Controls",children:[Object(N.jsx)("div",{className:"ButtonWrapper",children:Object(N.jsx)("button",{className:"Button IconWrapper",children:Object(N.jsx)(k.a,{icon:["fas",c.icon],onClick:function(){return s(),n()},title:c.title})})}),Object(N.jsx)("div",{className:"ButtonWrapper",children:Object(N.jsx)("button",{className:"Button IconWrapper",children:Object(N.jsx)(k.a,{icon:["fas",r],onClick:function(){return s(),t()},title:"Game strat/finish (N)"})})}),Object(N.jsx)("div",{className:"ButtonWrapper",children:Object(N.jsx)("button",{className:"Button IconWrapper",children:Object(N.jsx)(k.a,{className:"sync-alt"===r?"HideBtn":"",icon:["fas","cog"],onClick:function(){return s(),a()},title:"Game settings (S)"})})})]})},D=function(e){var t=e.settingRecordType,n=e.value,a=e.booleanValue,r=e.getNewValue,i=e.getNewBooleanValue,s=e.gameConfig,o=Object(j.a)(T,{volume:.5}),l=Object(u.a)(o,1)[0],d=function(e){if(l(),r&&n)switch(t){case c.RowSize:return r(e?n<8?n+=1:n:n>4?n-=1:n);case c.NewTiles:return r(e?n<3?n+=1:n:n>1?n-=1:n)}else if(i&&(a||!1===a))return i(!a)},f=function(e){return"open"===e&&(t===c.RowSize&&4===n||t===c.NewTiles&&1===n)||"close"===e&&(t===c.RowSize&&8===n||t===c.NewTiles&&3===n)?"HideBtn":void 0};return Object(N.jsxs)("div",{className:"SettingRecordWrapper",children:[Object(N.jsx)("p",{className:"Name",children:Object(N.jsx)("b",{children:t+": "})}),Object(N.jsx)("button",{className:"Button IconWrapper IconWrapper__settingRecord IconContainer ".concat(s.isDarkTheme?"DarkTheme":""),children:Object(N.jsx)(k.a,{className:f("open"),icon:["fas","caret-left"],onClick:function(){return d(!1)},title:"-"})}),Object(N.jsx)("p",{className:"Value",children:Object(N.jsx)("b",{children:n||(a?"Dark":"Light")})}),Object(N.jsx)("button",{className:"Button IconWrapper IconWrapper__settingRecord IconContainer ".concat(s.isDarkTheme?"DarkTheme":""),children:Object(N.jsx)(k.a,{className:f("close"),icon:["fas","caret-right"],onClick:function(){return d(!0)},title:"+"})})]})},W=function(e){var t=e.openModal,n=e.passToParentGameConfig,a=e.gameConfig,i=e.closeSettings,s=Object(r.useState)(a),o=Object(u.a)(s,2),d=o[0],f=o[1],m=Object(j.a)(T,{volume:.5}),b=Object(u.a)(m,1)[0],p=function(e){var t=1/8,n=450/(e+e*t+t);return{size:e,tileWidth:n,tileGap:n*t}};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"BackDrop ".concat(t&&"SetBackDrop")}),Object(N.jsx)("div",{className:"ModalDlg Description ".concat(t&&"OpenModal"," ").concat(a.isDarkTheme?"DarkTheme":""),children:Object(N.jsxs)("div",{className:"SettingsContentWrapper",children:[Object(N.jsx)("h3",{children:"Game settins:"}),Object(N.jsx)(D,{gameConfig:a,settingRecordType:c.RowSize,value:d.size,getNewValue:function(e){return t=e,f(Object(l.a)(Object(l.a)({},d),p(t))),void n(Object(l.a)(Object(l.a)({},d),p(t)));var t}}),Object(N.jsx)(D,{gameConfig:a,settingRecordType:c.NewTiles,value:d.newTilesQuantity,getNewValue:function(e){return t=e,f(d),f(Object(l.a)(Object(l.a)({},d),{},{newTilesQuantity:t})),void n(Object(l.a)(Object(l.a)({},d),{},{newTilesQuantity:t}));var t}}),Object(N.jsx)(D,{gameConfig:a,settingRecordType:c.ColorTheme,booleanValue:d.isDarkTheme,getNewBooleanValue:function(e){return t=e,f(Object(l.a)(Object(l.a)({},d),{},{isDarkTheme:t})),void n(Object(l.a)(Object(l.a)({},d),{},{isDarkTheme:t}));var t}}),Object(N.jsx)("button",{className:"Button IconWrapper IconWrapper__closeBtn ".concat(a.isDarkTheme?"DarkTheme":""),children:Object(N.jsx)(k.a,{icon:["fas","times"],onClick:function(){return b(),i()},title:"Close (Esc)"})})]})})]})},B=function(e){var t=e.openModal,n=e.gameConfig,c=e.closeSettings,a=Object(r.useState)(n),i=Object(u.a)(a,2),s=(i[0],i[1],Object(j.a)(T,{volume:.5})),o=Object(u.a)(s,1)[0];return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"BackDrop ".concat(t&&"SetBackDrop")}),Object(N.jsx)("div",{className:"ModalDlg Description ".concat(t&&"OpenModal"," ").concat(n.isDarkTheme?"DarkTheme":""),children:Object(N.jsxs)("div",{className:"SettingsContentWrapper",children:[Object(N.jsx)("h3",{children:"Controlls:"}),Object(N.jsxs)("div",{className:"Description",children:[Object(N.jsxs)("p",{children:[Object(N.jsx)("b",{children:"Gameplay"}),": Arrows or W, S, A, D"]}),Object(N.jsxs)("p",{children:[Object(N.jsx)("b",{children:"Game strat / finish"}),": N"]}),Object(N.jsxs)("p",{children:[Object(N.jsx)("b",{children:" Music start / stop"}),": M"]}),Object(N.jsxs)("p",{children:[Object(N.jsx)("b",{children:"Game settings"}),": C"]}),Object(N.jsxs)("p",{children:[Object(N.jsx)("b",{children:"Escape game settings"}),": Esc"]})]}),Object(N.jsx)("button",{className:"Button IconWrapper IconWrapper__closeBtn ".concat(n.isDarkTheme?"DarkTheme":""),children:Object(N.jsx)(k.a,{icon:["fas","times"],onClick:function(){return o(),c()},title:"Close (Esc)"})})]})})]})},I=function(){var e,t={musicOn:!1,icon:"music",title:"Play music (M)"},n={musicOn:!0,icon:"stop",title:"Play music (M)"},c=localStorage.getItem("tileList"),i=Object(r.useState)(c?JSON.parse(c):[]),s=Object(u.a)(i,2),o=s[0],b=s[1],p=localStorage.getItem("gameConfig"),O=Object(r.useState)(p?JSON.parse(p):{size:4,tileWidth:100,tileGap:10,newTilesQuantity:2,isDarkTheme:!1,gameCount:0}),g=Object(u.a)(O,2),x=g[0],w=g[1],y=Object(r.useState)(c&&JSON.parse(c).length?"sync-alt":"gamepad"),D=Object(u.a)(y,2),I=D[0],G=D[1],R=Object(r.useState)(!1),L=Object(u.a)(R,2),M=L[0],A=L[1],_=Object(r.useState)(t),E=Object(u.a)(_,2),z=E[0],K=E[1],F=Object(r.useState)(!1),V=Object(u.a)(F,2),Q=V[0],J=V[1],P=Object(r.useState)(!1),H=Object(u.a)(P,2),U=H[0],Y=H[1],q=Object(j.a)(d),X=Object(u.a)(q,2),Z=X[0],$=X[1],ee=$.stop,te=$.sound,ne=Object(j.a)(f),ce=Object(u.a)(ne,1)[0],ae=Object(j.a)(T,{volume:.5}),re=Object(u.a)(ae,1)[0],ie=(e=x.size,Array.from({length:e}).reduce((function(t,n,c){return t.push.apply(t,Object(m.a)(Array.from({length:e},(function(e,t){return{row:c+1,col:t+1}})))),t}),[]));Object(r.useEffect)((function(){localStorage.setItem("gameConfig",JSON.stringify(x)),localStorage.setItem("tileList",JSON.stringify(o));var e=function(e){var t=e.code,c=ce,r="";if("sync-alt"===I&&(t===a.ArrowUp||t===a.KeyUp?(r="up",c=ce):t===a.ArrowDown||t===a.KeyDown?(c=ce,r="down"):t===a.ArrowRight||t===a.KeyRight?(c=ce,r="right"):t!==a.ArrowLeft&&t!==a.KeyLeft||(c=ce,r="left")),t===a.EscapeSettings&&(J(!1),xe("expand-alt")),t===a.Settings&&oe(Q),t===a.NewGame&&se(),r){c();var i=v(o,r,x.size);i.find((function(e){return 2048===e.value}))&&(Te("You WIN!!!"),G("gamepad"));var s=i.reduce((function(e,t){return t.merged&&t.value&&(e+=t.value),e}),0),u=x.gameCount?x.gameCount+s:s;w(Object(l.a)(Object(l.a)({},x),{},{gameCount:u}));var j=h(ie,i,x.newTilesQuantity).tileList;h(ie,i,x.newTilesQuantity).statusResult&&"over"===h(ie,i,x.newTilesQuantity).statusResult&&(Te("Game over..."),G("gamepad"),K(n),b([]),w(Object(l.a)(Object(l.a)({},x),{},{gameCount:0})),localStorage.setItem("tileList",JSON.stringify(o))),b(j),r=""}};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[o,Z]);var se=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e)if(fe(!1),he("play"),A(!M),"gamepad"===I){var t;G("sync-alt"),Te(""),ee(t),K(n);var c=h(ie,[],x.newTilesQuantity).tileList;b(c),t=Z(),te.loop(!0),te.fade(0,.2,2e3,t)}else G("gamepad"),ee(),K(n),b([]),w(Object(l.a)(Object(l.a)({},x),{},{gameCount:0}));else{var a;Te(""),ee(a),K(n);var r=h(ie,[],x.newTilesQuantity).tileList;b(r),a=Z(),te.loop(!0),te.fade(0,.2,2e3,a)}},oe=function(e){J(!e)},le=function(e){Y(!e)},ue=Object(r.useState)(!1),je=Object(u.a)(ue,2),de=je[0],fe=je[1],me=Object(r.useState)("play"),be=Object(u.a)(me,2),pe=be[0],he=be[1];Object(r.useEffect)((function(){if(de){var e=setTimeout((function(){Math.floor(4*Math.random());var e=["up","down","right","left"][Math.floor(4*Math.random())],t=v(o,e,x.size),n=h(ie,t,x.newTilesQuantity).tileList;b(n)}),600);return function(){clearInterval(e)}}}),[o,Z]);var Oe=Object(r.useState)("expand-alt"),ge=Object(u.a)(Oe,2),ve=ge[0],xe=ge[1],we=function(){re(),"expand-alt"===ve?document.documentElement.webkitRequestFullscreen():document.webkitExitFullscreen()};Object(r.useEffect)((function(){var e=function(){xe("expand-alt"!==ve?"expand-alt":"compress-alt")};return document.addEventListener("webkitfullscreenchange",e),function(){document.removeEventListener("webkitfullscreenchange",e)}}),[we]);var Ne,ye=Object(r.useState)(""),Se=Object(u.a)(ye,2),ke=Se[0],Te=Se[1];return Object(N.jsxs)("div",{className:"GameWrapper ".concat(x.isDarkTheme?"DarkTheme":""),children:[Object(N.jsxs)("div",{style:{position:"fixed",top:"25px",right:"50%",transform:"translate(230px)"},children:[Object(N.jsx)("button",{className:"Button IconWrapper IconWrapper__upperBtn",children:Object(N.jsx)(k.a,{className:"sync-alt"===I?"HideBtn":"",icon:["fas",pe],onClick:function(){return Te(""),re(),fe(!de),void(de?(he("play"),ee(),K(n),b([])):(he("times-circle"),se(!1)))},title:"Autoplay on/off"})}),Object(N.jsx)("button",{className:"Button IconWrapper IconWrapper__upperBtn",title:"Game controlls",children:Object(N.jsx)(k.a,{icon:["fas","list-alt"],onClick:function(){return le(U)}})}),Object(N.jsx)("button",{className:"Button IconWrapper IconWrapper__upperBtn",title:"Last 10 results",children:Object(N.jsx)(k.a,{icon:["fas","list-ol"],onClick:function(){return le(U)}})}),Object(N.jsx)("button",{className:"Button IconWrapper IconWrapper__upperBtn",onClick:function(){return we()},title:"Full screen on/off",children:Object(N.jsx)(k.a,{icon:["fas",ve]})})]}),Object(N.jsxs)("div",{className:"BoardWrapper ".concat(x.isDarkTheme?"DarkTheme":""),style:{height:450,width:450,padding:x.tileGap},children:[Object(N.jsx)("div",{className:"ResultOverLay ".concat(ke?"ShowResult":""," ").concat(x.isDarkTheme?"DarkTheme":""),onClick:function(){return Te("")},children:ke}),Object(N.jsx)("div",{className:"GridWrapper",children:(Ne=x,Array.from({length:Ne.size},(function(e,t){return Object(N.jsx)("div",{className:"Row",style:{height:Ne.tileWidth,marginBottom:Ne.tileGap},children:Array.from({length:Ne.size},(function(e,t){return Object(N.jsx)("div",{className:"Cell ".concat(x.isDarkTheme?"DarkTheme":""),style:{height:Ne.tileWidth,width:Ne.tileWidth,marginRight:Ne.tileGap}},"cell-col-".concat(t+1))}))},"cell-row-".concat(t+1))})))}),Object(N.jsx)(S,{tileList:o,gameConfig:x})]}),Object(N.jsx)(C,{startNewGame:function(){return se()},startBtnIcon:I,toggleMusic:function(){return function(e){e.musicOn?(te.fade(.2,0,2e3),ee(),K(t)):(Z(),te.loop(!0),te.fade(0,.2,2e3),K(n))}(z)},musicConfig:z,openSettings:function(){return oe(Q)}}),Object(N.jsx)("div",{style:{fontSize:"64px",fontWeight:"bold"},children:x.gameCount}),Object(N.jsx)(W,{openModal:Q,passToParentGameConfig:function(e){w(e)},closeSettings:function(){return oe(!0)},gameConfig:x}),Object(N.jsx)(B,{openModal:U,passToParentGameConfig:function(e){w(e)},closeSettings:function(){return le(!0)},gameConfig:x})]})};var G=function(){return Object(N.jsx)("div",{className:"App",children:Object(N.jsx)(I,{})})},R=function(e){e&&e instanceof Function&&n.e(4).then(n.bind(null,64)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))},L=n(13),M=n(29),A=n(8);L.b.add(A.c,A.h,A.q,A.g,M.a,A.k,A.m,A.d,A.b,A.a,A.o,A.f,A.e,A.l,A.p,A.n,A.j,A.i);var _=function(){return Object(N.jsx)("div",{className:"Header",children:Object(N.jsx)("h1",{className:"Title",children:"2048"})})};var E=function(){return Object(N.jsxs)("div",{className:"Footer",children:[Object(N.jsx)("div",{className:"HrefWrapper",title:"Author",children:Object(N.jsxs)("a",{href:"https://github.com/GYegor",target:"_blank",children:[Object(N.jsx)("p",{children:Object(N.jsx)(k.a,{className:"FaIcon",icon:["fab","github"]})}),Object(N.jsx)("p",{children:"GYegor"})]})}),Object(N.jsx)("div",{className:"HrefWrapper",title:"Rolling Scopes School",children:Object(N.jsx)("a",{href:"https://rs.school/js/",target:"_blank",children:Object(N.jsx)("img",{src:"https://rs.school/images/rs_school_js.svg",alt:"RSSchool logo"})})})]})},z=Object(N.jsx)(o.a,{children:Object(N.jsxs)("div",{className:"Main",children:[Object(N.jsx)(_,{}),Object(N.jsx)(G,{}),Object(N.jsx)("div",{className:"Spacer"}),Object(N.jsx)(E,{})]})});s.a.render(z,document.getElementById("root")),R()}},[[60,1,2]]]);
//# sourceMappingURL=main.caf5e59d.chunk.js.map